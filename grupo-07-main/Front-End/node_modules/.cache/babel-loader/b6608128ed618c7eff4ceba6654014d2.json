{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\nahue\\\\LEANDRO\\\\ProyectoIntegradorTerminado\\\\grupo-07-main\\\\Front-End\\\\src\\\\views\\\\Booking.jsx\";\nimport React, { useEffect, useState, useContext } from \"react\";\nimport axios from \"axios\";\nimport { useParams } from \"react-router-dom\";\nimport { UserContext } from \"../context/User/UserContext\";\nimport \"../styles/Booking/booking.css\";\nimport dayjs from \"dayjs\";\nimport ProductHeader from \"../components/Booking/BookingHeader\";\nimport ProductPolicies from \"../components/Products/ProductPolicies\";\nimport BookingUser from \"../components/Booking/BookingUser\";\nimport BookingCalendar from \"../components/Booking/BookingCalendar\";\nimport BookingTime from \"../components/Booking/BookingTime\";\nimport BookingDetail from \"../components/Booking/BookingDetail\";\nimport SuccessfulMessage from \"../components/Global/SuccessfulMessage\";\nimport { CarContext } from \"../context/Car/CarContext\";\nimport 'animate.css';\n\nconst Booking = () => {\n  const {\n    cars\n  } = useContext(CarContext);\n  const {\n    id\n  } = useContext(UserContext);\n  const params = useParams();\n  const initialValues = {\n    city: \"\",\n    time: \"\",\n    start_date: \"\",\n    end_date: \"\",\n    user: {\n      id: \"\"\n    },\n    car: {\n      id: parseInt(params.productId)\n    }\n  };\n  const [formValues, setFormValues] = useState(initialValues);\n  const [formErrors, setFormErrors] = useState({});\n  const [car, setCar] = useState(null);\n  const [date, setDate] = useState(new Date());\n  const [time, setTime] = useState(null);\n  const [isSubmit, setIsSubmit] = useState(false);\n  const [bookingSuccess, setBookingSuccess] = useState(false);\n  useEffect(() => {\n    if (cars.data) {\n      const filtered = cars.data.find(item => parseInt(params.productId) === item.id);\n      setCar(filtered);\n    }\n  }, [cars]); //logicaform\n\n  const changeHandlerCity = e => {\n    const {\n      value\n    } = e.target;\n    setFormValues({ ...formValues,\n      city: value\n    });\n  };\n\n  useEffect(() => {\n    setFormValues({ ...formValues,\n      time: time + \":00\"\n    });\n  }, [time]);\n  useEffect(() => {\n    setFormValues({ ...formValues,\n      start_date: dayjs(date[0]).format(\"YYYY-MM-DD\"),\n      end_date: dayjs(date[1]).format(\"YYYY-MM-DD\")\n    });\n  }, [date]);\n  useEffect(() => {\n    setFormValues({ ...formValues,\n      user: {\n        id: id\n      }\n    });\n  }, [id]);\n\n  const submitHandler = e => {\n    e.preventDefault();\n    setFormErrors(validate(formValues));\n    setIsSubmit(true);\n  };\n\n  useEffect(() => {\n    if (Object.keys(formErrors).length === 0 && isSubmit) {\n      const logBooking = async () => {\n        try {\n          await axios.post(\"http://54.176.81.27:8080/reservas/agregar\", formValues);\n          setBookingSuccess(true);\n        } catch (error) {\n          console.log(error);\n        }\n      };\n\n      logBooking();\n    }\n  }, [formErrors]);\n\n  const validate = values => {\n    const errors = {};\n\n    if (!values.city) {\n      errors.city = \"La ciudad es requerida\";\n    }\n\n    if (!values.time) {\n      errors.time = \"El horario es requerido\";\n    }\n\n    if (!values.start_date || !values.end_date) {\n      errors.start_date = \"Las fechas son requeridas\";\n    }\n\n    return errors;\n  };\n\n  return /*#__PURE__*/React.createElement(React.Fragment, null, car && (bookingSuccess ? /*#__PURE__*/React.createElement(SuccessfulMessage, {\n    text: \"Su reserva se ha realizado con \\xE9xito\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 117,\n      columnNumber: 11\n    }\n  }) : /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(ProductHeader, {\n    title: car.title,\n    id: car.id,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 120,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 121,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"booking-form\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 122,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(\"form\", {\n    onSubmit: submitHandler,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 123,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"h2\", {\n    className: \"booking-form-h2\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 124,\n      columnNumber: 19\n    }\n  }, \"Complet\\xE1 tus datos\"), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"booking-containerForm\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 125,\n      columnNumber: 19\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"containerForm-containerData-Izq data\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 126,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(BookingUser, {\n    changeHandlerCity: changeHandlerCity,\n    errors: formErrors,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 127,\n      columnNumber: 23\n    }\n  }), /*#__PURE__*/React.createElement(BookingCalendar, {\n    setDate: setDate,\n    bookings: car.bookings,\n    errors: formErrors,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 131,\n      columnNumber: 23\n    }\n  }), /*#__PURE__*/React.createElement(BookingTime, {\n    setTime: setTime,\n    errors: formErrors,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 136,\n      columnNumber: 23\n    }\n  })), /*#__PURE__*/React.createElement(BookingDetail, {\n    submitHandler: submitHandler,\n    car: car,\n    date: date,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 138,\n      columnNumber: 21\n    }\n  })))), /*#__PURE__*/React.createElement(ProductPolicies, {\n    policies: car.policies,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 147,\n      columnNumber: 15\n    }\n  })))));\n};\n\nexport default Booking;","map":{"version":3,"names":["React","useEffect","useState","useContext","axios","useParams","UserContext","dayjs","ProductHeader","ProductPolicies","BookingUser","BookingCalendar","BookingTime","BookingDetail","SuccessfulMessage","CarContext","Booking","cars","id","params","initialValues","city","time","start_date","end_date","user","car","parseInt","productId","formValues","setFormValues","formErrors","setFormErrors","setCar","date","setDate","Date","setTime","isSubmit","setIsSubmit","bookingSuccess","setBookingSuccess","data","filtered","find","item","changeHandlerCity","e","value","target","format","submitHandler","preventDefault","validate","Object","keys","length","logBooking","post","error","console","log","values","errors","title","bookings","policies"],"sources":["C:/Users/nahue/LEANDRO/ProyectoIntegradorTerminado/grupo-07-main/Front-End/src/views/Booking.jsx"],"sourcesContent":["import React, { useEffect, useState, useContext } from \"react\";\nimport axios from \"axios\";\nimport { useParams } from \"react-router-dom\";\nimport { UserContext } from \"../context/User/UserContext\";\nimport \"../styles/Booking/booking.css\";\nimport dayjs from \"dayjs\";\n\nimport ProductHeader from \"../components/Booking/BookingHeader\";\nimport ProductPolicies from \"../components/Products/ProductPolicies\";\nimport BookingUser from \"../components/Booking/BookingUser\";\nimport BookingCalendar from \"../components/Booking/BookingCalendar\";\nimport BookingTime from \"../components/Booking/BookingTime\";\nimport BookingDetail from \"../components/Booking/BookingDetail\";\nimport SuccessfulMessage from \"../components/Global/SuccessfulMessage\";\nimport { CarContext } from \"../context/Car/CarContext\";\nimport 'animate.css';\n\nconst Booking = () => {\n  const { cars } = useContext(CarContext);\n  const { id } = useContext(UserContext);\n  const params = useParams();\n\n  const initialValues = {\n    city: \"\",\n    time: \"\",\n    start_date: \"\",\n    end_date: \"\",\n    user: { id: \"\" },\n    car: { id: parseInt(params.productId) },\n  };\n  const [formValues, setFormValues] = useState(initialValues);\n  const [formErrors, setFormErrors] = useState({});\n\n  const [car, setCar] = useState(null);\n  const [date, setDate] = useState(new Date());\n  const [time, setTime] = useState(null);\n\n  const [isSubmit, setIsSubmit] = useState(false);\n  const [bookingSuccess, setBookingSuccess] = useState(false);\n\n  useEffect(() => {\n    if (cars.data) {\n      const filtered = cars.data.find(\n        (item) => parseInt(params.productId) === item.id\n      );\n      setCar(filtered);\n    }\n  }, [cars]);\n\n  //logicaform\n  const changeHandlerCity = (e) => {\n    const { value } = e.target;\n    setFormValues({ ...formValues, city: value });\n  };\n\n  useEffect(() => {\n    setFormValues({ ...formValues, time: time + \":00\" });\n  }, [time]);\n\n  useEffect(() => {\n    setFormValues({\n      ...formValues,\n      start_date: dayjs(date[0]).format(\"YYYY-MM-DD\"),\n      end_date: dayjs(date[1]).format(\"YYYY-MM-DD\"),\n    });\n  }, [date]);\n\n  useEffect(() => {\n    setFormValues({ ...formValues, user: { id: id } });\n  }, [id]);\n\n  const submitHandler = (e) => {\n    e.preventDefault();\n    setFormErrors(validate(formValues));\n    setIsSubmit(true);\n  };\n\n  useEffect(() => {\n    if (Object.keys(formErrors).length === 0 && isSubmit) {\n      const logBooking = async () => {\n        try {\n          await axios.post(\n            \"http://54.176.81.27:8080/reservas/agregar\",\n            formValues\n          );\n          setBookingSuccess(true);\n        } catch (error) {\n          console.log(error);\n        }\n      };\n      logBooking();\n    }\n  }, [formErrors]);\n\n  const validate = (values) => {\n    const errors = {};\n\n    if (!values.city) {\n      errors.city = \"La ciudad es requerida\";\n    }\n\n    if (!values.time) {\n      errors.time = \"El horario es requerido\";\n    }\n\n    if (!values.start_date || !values.end_date) {\n      errors.start_date = \"Las fechas son requeridas\";\n    }\n\n    return errors;\n  };\n\n  return (\n    <>\n      {car &&\n        (bookingSuccess ? (\n          <SuccessfulMessage text=\"Su reserva se ha realizado con éxito\" />\n        ) : (\n          <>\n            <ProductHeader title={car.title} id={car.id} />\n            <div >\n              <div className=\"booking-form\">\n                <form onSubmit={submitHandler}>\n                  <h2 className=\"booking-form-h2\">Completá tus datos</h2>\n                  <div className=\"booking-containerForm\">\n                    <div className=\"containerForm-containerData-Izq data\">\n                      <BookingUser\n                        changeHandlerCity={changeHandlerCity}\n                        errors={formErrors}\n                      />\n                      <BookingCalendar\n                        setDate={setDate}\n                        bookings={car.bookings}\n                        errors={formErrors}\n                      />\n                      <BookingTime setTime={setTime} errors={formErrors} />\n                    </div>\n                    <BookingDetail\n                      submitHandler={submitHandler}\n                      car={car}\n                      date={date}\n                    />\n                  </div>\n                </form>\n              </div>\n\n              <ProductPolicies policies={car.policies} />\n            </div>\n          </>\n        ))}\n    </>\n  );\n};\n\nexport default Booking;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}